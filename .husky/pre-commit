#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üîß Running Prettier on frontend files (excluding ignored files)..."
npx prettier --write --ignore-path .prettierignore .

echo "üîç Running frontend lint checks..."
npm run lint || exit 1

echo "üßπ Running gofmt on Go files..."
find . -type f -name '*.go' -not -path "./vendor/*" | xargs gofmt -w

echo "üß™ Running golint (optional)..."
if command -v golint >/dev/null 2>&1; then
  golint ./... || echo "‚ÑπÔ∏è golint produced warnings (non-blocking)."
else
  echo "‚ö†Ô∏è golint not installed. Run: go install golang.org/x/lint/golint@latest"
fi

echo "üîí Running gosec for security checks..."
if command -v gosec >/dev/null 2>&1; then
  gosec ./... || echo "‚ö†Ô∏è gosec found issues."
else
  echo "‚ÑπÔ∏è gosec not installed. Run: go install github.com/securego/gosec/v2/cmd/gosec@latest"
fi

echo "‚úÖ All pre-commit checks passed."
